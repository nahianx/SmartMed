generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  String               @id @default(uuid())
  email               String               @unique
  fullName            String?
  passwordHash        String?
  role                UserRole
  authProvider        AuthProvider         @default(LOCAL)
  googleId            String?              @unique
  emailVerified       Boolean              @default(false)
  isActive            Boolean              @default(true)
  lastLogin           DateTime?
  phoneNumber         String?
  dateOfBirth         DateTime?
  gender              Gender?
  addressLine1        String?
  addressLine2        String?
  city                String?
  region              String?
  postalCode          String?
  country             String?
  profilePhotoUrl     String?
  isMfaEnabled        Boolean              @default(false)
  mfaSecret           String? // Encrypted TOTP secret
  mfaBackupCodes      String[] // Hashed backup codes
  mfaVerifiedAt       DateTime? // When MFA was last verified
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  doctor              Doctor?
  notifications       Notification[]
  patient             Patient?
  sessions            UserSession[]
  passwordResets      PasswordReset[]
  emailVerifications  EmailVerification[]
  auditLogs           AuditLog[]
  healthTips          HealthTip[]
  healthTipPreference HealthTipPreference?

  @@map("users")
}

model Patient {
  id               String            @id @default(uuid())
  userId           String            @unique
  firstName        String
  lastName         String
  dateOfBirth      DateTime
  gender           Gender
  phoneNumber      String
  address          String
  emergencyContact String?
  bloodGroup       String?
  allergies        Json?
  medicalHistory   String?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  activities       Activity[]
  appointments     Appointment[]
  user             User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  prescriptions    Prescription[]
  reports          Report[]
  preferredBy      PreferredDoctor[]
  queueEntries     QueueEntry[]

  @@map("patients")
}

model Doctor {
  id                      String                   @id @default(uuid())
  userId                  String                   @unique
  firstName               String
  lastName                String
  specialization          String
  qualification           String
  experience              Int
  phoneNumber             String
  licenseNumber           String                   @unique
  consultationFee         Float
  // Deprecated: use DoctorAvailability instead of JSON schedules.
  availableDays           Json
  // Deprecated: use DoctorAvailability instead of JSON schedules.
  availableTimeSlots      Json
  clinicId                String?
  timezone                String                   @default("UTC")
  availabilityStatus      DoctorAvailabilityStatus @default(OFF_DUTY)
  isAvailable             Boolean                  @default(false)
  currentPatientId        String?
  currentQueueEntryId     String?
  lastStatusChange        DateTime?
  averageConsultationTime Int                      @default(15)
  todayServed             Int                      @default(0)
  todayNoShows            Int                      @default(0)
  totalServed             Int                      @default(0)
  allowWalkIns            Boolean                  @default(true)
  allowOnlineBooking      Boolean                  @default(true)
  autoCallNext            Boolean                  @default(false)
  noShowTimeout           Int                      @default(30)
  statsDate               String                   @default("")
  createdAt               DateTime                 @default(now())
  updatedAt               DateTime                 @updatedAt
  activities              Activity[]
  appointments            Appointment[]
  user                    User                     @relation(fields: [userId], references: [id], onDelete: Cascade)
  prescriptions           Prescription[]
  reports                 Report[]
  clinic                  Clinic?                  @relation(fields: [clinicId], references: [id])
  availability            DoctorAvailability[]
  specializations         DoctorSpecialization[]
  preferredBy             PreferredDoctor[]
  queueEntries            QueueEntry[]
  queueCounters           QueueCounter[]

  @@map("doctors")
}

model Clinic {
  id              String   @id @default(uuid())
  name            String
  address         String
  phone           String
  consultationFee Float
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  doctors         Doctor[]

  @@map("clinics")
}

model Appointment {
  id            String            @id @default(uuid())
  patientId     String
  doctorId      String
  dateTime      DateTime
  duration      Int
  status        AppointmentStatus @default(SCHEDULED)
  reason        String
  notes         String?
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  activities    Activity[]
  doctor        Doctor            @relation(fields: [doctorId], references: [id])
  patient       Patient           @relation(fields: [patientId], references: [id])
  notifications Notification[]
  prescriptions Prescription[]
  reports       Report[]
  queueEntry    QueueEntry?

  @@unique([doctorId, dateTime])
  @@map("appointments")
}

model Prescription {
  id                        String                    @id @default(uuid())
  appointmentId             String
  patientId                 String
  doctorId                  String
  medications               Json // Legacy field for backward compatibility
  diagnosis                 String
  notes                     String?
  // Interaction check results
  interactionCheckStatus    InteractionCheckStatus    @default(NOT_CHECKED)
  interactionOverrideReason String?
  interactionOverrideAt     DateTime?
  createdAt                 DateTime                  @default(now())
  updatedAt                 DateTime                  @updatedAt
  activities                Activity[]
  appointment               Appointment               @relation(fields: [appointmentId], references: [id])
  doctor                    Doctor                    @relation(fields: [doctorId], references: [id])
  patient                   Patient                   @relation(fields: [patientId], references: [id])
  // New structured medications relation
  prescriptionMedications   PrescriptionMedication[]
  interactionChecks         InteractionCheck[]
  // Secure access tokens for external viewing
  accessTokens              PrescriptionAccessToken[]

  @@map("prescriptions")
}

// Secure token-based access for prescriptions (PHI protection)
model PrescriptionAccessToken {
  id             String       @id @default(uuid())
  token          String       @unique
  prescriptionId String
  purpose        TokenPurpose @default(VIEW)
  expiresAt      DateTime
  maxUses        Int          @default(1)
  usedCount      Int          @default(0)
  lastUsedAt     DateTime?
  lastUsedIp     String?
  createdAt      DateTime     @default(now())

  prescription Prescription @relation(fields: [prescriptionId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([prescriptionId])
  @@index([expiresAt])
  @@map("prescription_access_tokens")
}

enum TokenPurpose {
  VIEW
  PRINT
  PHARMACY
}

// ==========================================
// Drug Database Models (RxNav Integration)
// ==========================================

model Drug {
  id                String   @id @default(uuid())
  rxcui             String   @unique
  name              String
  genericName       String?
  brandNames        String[] @default([])
  tty               String // Term Type (IN, BN, SCD, SBD, etc.)
  synonyms          String[] @default([])
  strength          String?
  dosageForm        String?
  route             String?
  drugClass         String[] @default([])
  activeIngredients String[] @default([])
  lastVerified      DateTime @default(now())
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  // Relations
  prescriptionMedications PrescriptionMedication[]
  interactionsAsDrug1     DrugInteraction[]        @relation("Drug1Interactions")
  interactionsAsDrug2     DrugInteraction[]        @relation("Drug2Interactions")

  @@index([name])
  @@index([genericName])
  @@index([rxcui])
  @@map("drugs")
}

model DrugInteraction {
  id             String              @id @default(uuid())
  drug1Rxcui     String
  drug2Rxcui     String
  severity       InteractionSeverity
  description    String
  clinicalEffect String?
  source         String              @default("RxNav")
  evidenceLevel  String?
  lastVerified   DateTime            @default(now())
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt

  // Relations
  drug1 Drug @relation("Drug1Interactions", fields: [drug1Rxcui], references: [rxcui])
  drug2 Drug @relation("Drug2Interactions", fields: [drug2Rxcui], references: [rxcui])

  @@unique([drug1Rxcui, drug2Rxcui])
  @@index([drug1Rxcui])
  @@index([drug2Rxcui])
  @@index([severity])
  @@map("drug_interactions")
}

model PrescriptionMedication {
  id              String          @id @default(uuid())
  prescriptionId  String
  drugRxcui       String? // Nullable for backward compatibility with unresolved drugs
  medicineName    String // User-entered or resolved drug name
  genericName     String?
  dosage          String // Display format: "500mg"
  dosageValue     Float? // Numeric value: 500
  dosageUnit      String? // Unit: "mg", "g", "ml", etc.
  frequency       String // Display format: "1-0-1"
  frequencyTimes  Int? // Times per period: 2
  frequencyPeriod String? // Period: "day", "week", etc.
  duration        String // Display format: "7 days"
  durationValue   Int? // Numeric value: 7
  durationUnit    String? // Unit: "days", "weeks", "months"
  route           MedicationRoute @default(ORAL)
  instructions    String?
  isResolved      Boolean         @default(false) // Whether drug was resolved to RxCUI
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  // Relations
  prescription Prescription @relation(fields: [prescriptionId], references: [id], onDelete: Cascade)
  drug         Drug?        @relation(fields: [drugRxcui], references: [rxcui])

  @@index([prescriptionId])
  @@index([drugRxcui])
  @@map("prescription_medications")
}

model InteractionCheck {
  id             String              @id @default(uuid())
  prescriptionId String
  drug1Rxcui     String
  drug1Name      String
  drug2Rxcui     String
  drug2Name      String
  severity       InteractionSeverity
  description    String
  wasOverridden  Boolean             @default(false)
  overrideReason String?
  overriddenBy   String? // Doctor ID who overrode
  overriddenAt   DateTime?
  checkedAt      DateTime            @default(now())

  // Relations
  prescription Prescription @relation(fields: [prescriptionId], references: [id], onDelete: Cascade)

  @@index([prescriptionId])
  @@index([severity])
  @@map("interaction_checks")
}

model PatientAllergy {
  id            String          @id @default(uuid())
  patientId     String
  allergenName  String // e.g., "Penicillin", "Aspirin"
  allergenType  AllergenType // DRUG, DRUG_CLASS, INGREDIENT, FOOD, OTHER
  allergenRxcui String? // RxCUI if it's a drug
  reaction      String? // Description of reaction
  severity      AllergySeverity @default(MODERATE)
  onsetDate     DateTime?
  verifiedBy    String? // Doctor ID who verified
  verifiedAt    DateTime?
  isActive      Boolean         @default(true)
  notes         String?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt

  @@index([patientId])
  @@index([allergenRxcui])
  @@index([allergenName])
  @@map("patient_allergies")
}

model AllergyCheck {
  id             String          @id @default(uuid())
  prescriptionId String?
  patientId      String
  drugRxcui      String
  drugName       String
  allergyId      String
  allergenName   String
  matchType      String // EXACT, DRUG_CLASS, INGREDIENT
  severity       AllergySeverity
  wasOverridden  Boolean         @default(false)
  overrideReason String?
  overriddenBy   String?
  overriddenAt   DateTime?
  checkedAt      DateTime        @default(now())

  @@index([prescriptionId])
  @@index([patientId])
  @@map("allergy_checks")
}

// Drug-related Enums
enum InteractionSeverity {
  HIGH // Contraindicated, avoid combination
  MODERATE // Use with caution, monitor
  LOW // Minor interaction, minimal clinical significance
}

enum InteractionCheckStatus {
  NOT_CHECKED
  PASSED
  WARNINGS_ACKNOWLEDGED
  FAILED
}

enum MedicationRoute {
  ORAL
  IV
  IM
  SUBCUTANEOUS
  TOPICAL
  INHALATION
  SUBLINGUAL
  RECTAL
  TRANSDERMAL
  OPHTHALMIC
  OTIC
  NASAL
  OTHER
}

enum AllergenType {
  DRUG
  DRUG_CLASS
  INGREDIENT
  FOOD
  ENVIRONMENTAL
  OTHER
}

enum AllergySeverity {
  MILD
  MODERATE
  SEVERE
  LIFE_THREATENING
}

model Report {
  id            String       @id @default(uuid())
  patientId     String
  doctorId      String?
  appointmentId String?
  fileKey       String
  fileName      String
  fileSize      Int
  mimeType      String
  uploadedAt    DateTime     @default(now())
  notes         String?
  activities    Activity[]
  appointment   Appointment? @relation(fields: [appointmentId], references: [id])
  doctor        Doctor?      @relation(fields: [doctorId], references: [id])
  patient       Patient      @relation(fields: [patientId], references: [id])

  @@map("reports")
}

model Activity {
  id             String             @id @default(uuid())
  type           ActivityType
  occurredAt     DateTime
  patientId      String
  doctorId       String?
  appointmentId  String?
  prescriptionId String?
  reportId       String?
  title          String
  subtitle       String?
  tags           Json
  status         AppointmentStatus?
  notes          String?
  vitals         Json?
  searchVector   Unsupported("tsvector")? @map("search_vector")
  createdAt      DateTime           @default(now())
  updatedAt      DateTime           @updatedAt
  appointment    Appointment?       @relation(fields: [appointmentId], references: [id])
  doctor         Doctor?            @relation(fields: [doctorId], references: [id])
  patient        Patient            @relation(fields: [patientId], references: [id])
  prescription   Prescription?      @relation(fields: [prescriptionId], references: [id])
  report         Report?            @relation(fields: [reportId], references: [id])
  notifications  Notification[]

  @@index([patientId, occurredAt(sort: Desc)])
  @@index([doctorId, occurredAt(sort: Desc)])
  @@index([type, occurredAt(sort: Desc)])
  @@map("activities")
}

model Notification {
  id            String           @id @default(uuid())
  userId        String
  type          NotificationType
  title         String
  body          String?
  activityId    String?
  appointmentId String?
  readAt        DateTime?
  createdAt     DateTime         @default(now())
  activity      Activity?        @relation(fields: [activityId], references: [id])
  appointment   Appointment?     @relation(fields: [appointmentId], references: [id])
  user          User             @relation(fields: [userId], references: [id])

  @@unique([userId, appointmentId, type], map: "unique_notification_per_appointment_type")
  @@index([userId, createdAt(sort: Desc)])
  @@map("notifications")
}

// Email delivery log for tracking and debugging
model EmailLog {
  id              String      @id @default(uuid())
  recipientEmail  String
  recipientUserId String?
  templateType    EmailType
  subject         String
  status          EmailStatus @default(PENDING)
  providerId      String? // External ID from email provider (e.g., Resend)
  metadata        Json? // Additional context (appointmentId, prescriptionId, etc.)
  errorMessage    String?
  errorCode       String?
  attempts        Int         @default(1)
  sentAt          DateTime?
  deliveredAt     DateTime?
  openedAt        DateTime?
  clickedAt       DateTime?
  bouncedAt       DateTime?
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  @@index([recipientEmail])
  @@index([recipientUserId])
  @@index([status])
  @@index([templateType])
  @@index([createdAt])
  @@index([providerId])
  @@map("email_logs")
}

enum EmailType {
  APPOINTMENT_CONFIRMATION
  APPOINTMENT_REMINDER
  APPOINTMENT_CANCELLATION
  PRESCRIPTION_NOTIFICATION
  HEALTH_TIP
  PASSWORD_RESET
  EMAIL_VERIFICATION
  WELCOME
  GENERAL
}

enum EmailStatus {
  PENDING
  QUEUED
  SENT
  DELIVERED
  OPENED
  CLICKED
  BOUNCED
  FAILED
  SPAM_COMPLAINT
}

// Web Push notification subscriptions
model PushSubscription {
  id           String    @id @default(uuid())
  userId       String
  endpoint     String    @unique
  p256dh       String // Public key for encryption
  auth         String // Auth secret for encryption
  userAgent    String? // Browser/device info
  deviceName   String? // User-friendly device name
  isActive     Boolean   @default(true)
  lastUsedAt   DateTime?
  failureCount Int       @default(0)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@index([userId])
  @@index([isActive])
  @@map("push_subscriptions")
}

// User notification preferences
model NotificationPreference {
  id     String @id @default(uuid())
  userId String @unique

  // Appointment notifications
  appointmentReminders    Boolean @default(true)
  appointmentConfirmation Boolean @default(true)
  appointmentCancellation Boolean @default(true)
  reminderTiming          String  @default("24h,1h") // Comma-separated: 24h, 1h, 30m

  // Queue notifications
  queueUpdates           Boolean @default(true)
  queuePositionThreshold Int     @default(3) // Notify when position <= this

  // Health tips notifications
  healthTipsEnabled   Boolean @default(true)
  healthTipsFrequency String  @default("DAILY") // DAILY, WEEKLY, MONTHLY

  // Prescription notifications
  prescriptionReady Boolean @default(true)

  // Delivery channels
  emailEnabled Boolean @default(true)
  pushEnabled  Boolean @default(true)
  smsEnabled   Boolean @default(false)

  // Audio and Browser Notifications (for doctors)
  audioNotificationsEnabled   Boolean @default(true)
  browserNotificationsEnabled Boolean @default(true)
  notificationSound           String  @default("notification-default") // Sound file name
  notificationVolume          Int     @default(70) // 0-100 volume percentage

  // Quiet hours (no notifications during this time)
  quietHoursEnabled Boolean @default(false)
  quietHoursStart   String? @default("22:00") // 24-hour format
  quietHoursEnd     String? @default("08:00")
  timezone          String  @default("UTC")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("notification_preferences")
}

model AuditLog {
  id            String      @id @default(uuid())
  userId        String?
  user          User?       @relation(fields: [userId], references: [id], onDelete: SetNull)
  userRole      String?
  action        AuditAction
  resourceType  String
  resourceId    String
  timestamp     DateTime    @default(now())
  metadata      Json?
  ipAddress     String?
  userAgent     String?
  success       Boolean     @default(true)
  errorMessage  String?
  retentionDate DateTime?

  @@index([userId])
  @@index([timestamp])
  @@index([resourceType, resourceId])
  @@index([action])
  @@index([userId, timestamp])
  @@index([resourceType, resourceId, timestamp])
  @@map("audit_logs")
}

model UserSession {
  id           String   @id @default(uuid())
  userId       String
  refreshToken String   @unique
  ipAddress    String?
  deviceInfo   Json?
  expiresAt    DateTime
  createdAt    DateTime @default(now())
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_sessions")
}

model PasswordReset {
  id         String   @id @default(uuid())
  userId     String
  resetToken String   @unique
  expiresAt  DateTime
  used       Boolean  @default(false)
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("password_resets")
}

model EmailVerification {
  id                String   @id @default(uuid())
  userId            String
  verificationToken String   @unique
  expiresAt         DateTime
  verified          Boolean  @default(false)
  createdAt         DateTime @default(now())
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("email_verifications")
}

model Specialization {
  id                    String                 @id @default(uuid())
  name                  String                 @unique
  doctorSpecializations DoctorSpecialization[]

  @@map("specializations")
}

model DoctorSpecialization {
  id               String         @id @default(uuid())
  doctorId         String
  specializationId String
  doctor           Doctor         @relation(fields: [doctorId], references: [id], onDelete: Cascade)
  specialization   Specialization @relation(fields: [specializationId], references: [id], onDelete: Cascade)

  @@unique([doctorId, specializationId], map: "unique_doctor_specialization")
  @@map("doctor_specializations")
}

model DoctorAvailability {
  id          String   @id @default(uuid())
  doctorId    String
  dayOfWeek   Int
  startTime   String
  endTime     String
  hasBreak    Boolean  @default(false)
  breakStart  String?
  breakEnd    String?
  isAvailable Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  doctor      Doctor   @relation(fields: [doctorId], references: [id], onDelete: Cascade)

  @@index([doctorId, dayOfWeek])
  @@map("doctor_availability")
}

model PreferredDoctor {
  id        String   @id @default(uuid())
  patientId String
  doctorId  String
  createdAt DateTime @default(now())
  patient   Patient  @relation(fields: [patientId], references: [id], onDelete: Cascade)
  doctor    Doctor   @relation(fields: [doctorId], references: [id], onDelete: Cascade)

  @@unique([patientId, doctorId], map: "unique_preferred_doctor")
  @@map("preferred_doctors")
}

model QueueEntry {
  id                String       @id @default(uuid())
  serialNumber      String       @unique
  doctorId          String
  patientId         String
  appointmentId     String?
  queueType         QueueType
  status            QueueStatus
  priority          Int          @default(2)
  position          Int
  estimatedWaitTime Int?
  checkInTime       DateTime
  scheduledTime     DateTime?
  calledTime        DateTime?
  startTime         DateTime?
  completedTime     DateTime?
  notes             String?
  version           Int          @default(0)
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
  doctor            Doctor       @relation(fields: [doctorId], references: [id])
  patient           Patient      @relation(fields: [patientId], references: [id])
  appointment       Appointment? @relation(fields: [appointmentId], references: [id])

  @@unique([appointmentId])
  @@index([doctorId, status, position])
  @@index([patientId, status])
  @@index([createdAt])
  @@index([doctorId, createdAt])
  @@map("queue_entries")
}

model QueueCounter {
  id         String   @id @default(uuid())
  doctorId   String
  queueDate  String
  nextSerial Int      @default(1)
  updatedAt  DateTime @updatedAt
  doctor     Doctor   @relation(fields: [doctorId], references: [id])

  @@unique([doctorId, queueDate], map: "unique_queue_counter")
  @@map("queue_counters")
}

// ==========================================
// Health Tips Models
// ==========================================

model HealthTip {
  id         String            @id @default(uuid())
  userId     String
  tipText    String
  category   HealthTipCategory
  source     HealthTipSource
  metadata   Json? // Model version, confidence, input context hash
  isRead     Boolean           @default(false)
  isArchived Boolean           @default(false)
  expiresAt  DateTime
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, tipText], map: "unique_user_tip")
  @@index([userId, createdAt(sort: Desc)])
  @@index([userId, isRead, isArchived])
  @@index([expiresAt])
  @@map("health_tips")
}

model HealthTipPreference {
  id              String                  @id @default(uuid())
  userId          String                  @unique
  enabled         Boolean                 @default(true)
  categories      HealthTipCategory[]
  frequency       HealthTipFrequency      @default(DAILY)
  deliveryMethod  HealthTipDeliveryMethod @default(IN_APP)
  lastGeneratedAt DateTime?
  createdAt       DateTime                @default(now())
  updatedAt       DateTime                @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("health_tip_preferences")
}

// ========================
// RBAC Permission System
// ========================

model Permission {
  id          String           @id @default(uuid())
  name        String           @unique // e.g., "appointments:create", "prescriptions:write"
  description String?
  resource    String // e.g., "appointments", "prescriptions", "users"
  action      PermissionAction // e.g., CREATE, READ, UPDATE, DELETE, MANAGE
  isSystem    Boolean          @default(false) // System permissions cannot be deleted
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  rolePermissions RolePermission[]

  @@index([resource])
  @@index([action])
  @@map("permissions")
}

model RolePermission {
  id           String     @id @default(uuid())
  role         UserRole
  permissionId String
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)
  grantedBy    String? // User ID who granted this permission
  grantedAt    DateTime   @default(now())

  @@unique([role, permissionId])
  @@index([role])
  @@map("role_permissions")
}

enum PermissionAction {
  CREATE
  READ
  UPDATE
  DELETE
  MANAGE // Full access including admin operations
  EXECUTE // For action-based permissions like "queue:call_next"
}

enum HealthTipCategory {
  GENERAL_WELLNESS
  NUTRITION
  EXERCISE
  MENTAL_HEALTH
  SLEEP
  MEDICATION
  PREVENTIVE_CARE
  CHRONIC_CONDITION
  LIFESTYLE
}

enum HealthTipSource {
  ML_GENERATED
  STATIC_FALLBACK
  CURATED
}

enum HealthTipFrequency {
  DAILY
  WEEKLY
  BI_WEEKLY
  MONTHLY
}

enum HealthTipDeliveryMethod {
  IN_APP
  EMAIL
  BOTH
}

enum ActivityType {
  APPOINTMENT
  PRESCRIPTION
  REPORT
}

enum AppointmentStatus {
  PENDING
  ACCEPTED
  REJECTED
  SCHEDULED
  CONFIRMED
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

enum NotificationType {
  APPOINTMENT_REMINDER_24H
  APPOINTMENT_REMINDER_1H
  ACTIVITY_CREATED
  ACTIVITY_UPDATED
  HEALTH_TIP_GENERATED
}

enum QueueType {
  WALK_IN
  ONLINE_BOOKING
}

enum QueueStatus {
  WAITING
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum DoctorAvailabilityStatus {
  AVAILABLE
  BUSY
  BREAK
  OFF_DUTY
}

enum AuditAction {
  LOGIN
  LOGOUT
  TOKEN_REFRESH
  FAILED_LOGIN
  PATIENT_HISTORY_ACCESS
  DOCTOR_HISTORY_ACCESS
  APPOINTMENT_VIEW
  MEDICAL_RECORD_VIEW
  PRESCRIPTION_VIEW
  REPORT_UPLOAD
  REPORT_VIEW
  PATIENT_CREATED
  PATIENT_UPDATED
  PATIENT_DELETED
  APPOINTMENT_CREATED
  APPOINTMENT_UPDATED
  APPOINTMENT_CANCELLED
  PRESCRIPTION_CREATED
  PRESCRIPTION_UPDATED
  DOCTOR_SEARCH
  APPOINTMENT_SEARCH
  PATIENT_SEARCH
  USER_ROLE_CHANGED
  PERMISSION_GRANTED
  PERMISSION_REVOKED
  PERMISSION_CREATED
  PERMISSION_UPDATED
  PERMISSION_DELETED
  PERMISSIONS_BULK_GRANTED
  PERMISSIONS_BULK_REVOKED
  PERMISSIONS_CLONED
  UNAUTHORIZED_ACCESS_ATTEMPT
  SUSPICIOUS_ACTIVITY
  // MFA-related audit actions
  MFA_SETUP_INITIATED
  MFA_ENABLED
  MFA_DISABLED
  MFA_VERIFIED
  MFA_VERIFICATION_FAILED
  MFA_BACKUP_CODES_REGENERATED
  // Queue-related audit actions
  QUEUE_ENTRY_ADDED
  QUEUE_ENTRY_REMOVED
  QUEUE_ENTRY_STATUS_CHANGED
  QUEUE_ENTRY_REORDERED
  QUEUE_CALLED_NEXT
  QUEUE_CHECK_IN
  DOCTOR_STATUS_CHANGED
  // Drug-related audit actions
  DRUG_SEARCH
  DRUG_LOOKUP
  INTERACTION_CHECK
  INTERACTION_OVERRIDE
  ALLERGY_CHECK
  ALLERGY_CONFLICT_OVERRIDE
  ALLERGY_ADDED
  ALLERGY_UPDATED
  ALLERGY_DELETED
}

enum UserRole {
  ADMIN
  DOCTOR
  PATIENT
  NURSE
}

enum AuthProvider {
  LOCAL
  GOOGLE
}
